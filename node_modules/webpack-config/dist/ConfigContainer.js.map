{"version":3,"sources":["../src/ConfigContainer.js"],"names":["CONTAINER","ConfigContainer","constructor","set","setUp","container","get","bindValue","process","env","bindClass","with","resolve","T","constitute","proxy","Proxy","construct"],"mappings":";;;;;;;;;;;;;;AAAA;;AAIA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;AAIA,MAAMA,YAAY,uBAAlB;;AAEA;;;AAGA,MAAMC,eAAN,CAAsB;AAClB;;;AAGAC,kBAAc;AACVF,kBAAUG,GAAV,CAAc,IAAd,EAAoB,2BAApB;;AAEA,aAAKC,KAAL;AACH;;AAED;;;;AAIA,QAAIC,SAAJ,GAAgB;AACZ,eAAOL,UAAUM,GAAV,CAAc,IAAd,CAAP;AACH;;AAED;;;;AAIAF,YAAQ;AACJ,cAAMC,YAAY,KAAKA,SAAvB;;AAEAA,kBAAUE,SAAV,CAAoBN,eAApB,EAAqC,IAArC;AACAI,kBAAUE,SAAV,8BAAuC,gCAAsB,uBAAeC,QAAQC,GAAvB,CAAtB,CAAvC;AACAJ,kBAAUK,SAAV,+CAA8C,6BAA9C;AAGAL,kBAAUE,SAAV,+BAAwC,kCAAxC;AACAF,kBAAUK,SAAV,iEAAgE,2DAAhE;AAIAL,kBAAUK,SAAV,6DAA4D,gCAA5D;AAGAL,kBAAUK,SAAV,iDAAgD,8EAAhD;AAKAL,kBAAUK,SAAV,mDAAkD,CAC9CT,eAD8C,CAAlD;AAGAI,kBAAUK,SAAV,qCAAoC,sBAAUC,IAAV,CAAe,gCAAf,CAApC;AAGAN,kBAAUK,SAAV,mEAAkE,gCAAlE;AAGAL,kBAAUK,SAAV,mEAAkE,iCAAlE;AAGAL,kBAAUK,SAAV,6DAA4D,iCAA5D;AAGAL,kBAAUK,SAAV,+DAA8D,kFAA9D;AAKAL,kBAAUK,SAAV,iEAAgE,CAC5DT,eAD4D,CAAhE;AAGH;;AAED;;;;AAIAW,YAAQC,CAAR,EAAW;AACP,eAAO,KAAKR,SAAL,CAAeS,UAAf,CAA0BD,CAA1B,CAAP;AACH;;AAED;;;;AAIAE,UAAMF,CAAN,EAAS;AACL,eAAO,IAAIG,KAAJ,CAAU,YAAW,CAAE,CAAvB,EAAyB;AAC5BC,uBAAW,MAAM;AACb,uBAAO,KAAKL,OAAL,CAAaC,CAAb,CAAP;AACH;AAH2B,SAAzB,CAAP;AAKH;AAtFiB;;kBAyFPZ,e","file":"ConfigContainer.js","sourcesContent":["import {\n    Container,\n    Transient\n} from 'constitute';\nimport Config from './Config';\nimport ConfigCache from './ConfigCache';\nimport ConfigEnvironment from './ConfigEnvironment';\nimport ConfigPatternCache from './ConfigPatternCache';\nimport ConfigStringResolver from './ConfigStringResolver';\nimport ConfigPathResolver from './ConfigPathResolver';\nimport ConfigLoader from './ConfigLoader';\nimport ConfigFactory from './ConfigFactory';\nimport ConfigOptionsResolver from './ConfigOptionsResolver';\nimport ConfigDefaultsCommand from './ConfigDefaultsCommand';\nimport ConfigMergeCommand from './ConfigMergeCommand';\nimport ConfigExtendCommand from './ConfigExtendCommand';\nimport ConfigCommandFactory from './ConfigCommandFactory';\n\n/**\n * @private\n * @type {WeakMap}\n */\nconst CONTAINER = new WeakMap();\n\n/**\n * @class\n */\nclass ConfigContainer {\n    /**\n     * @constructor\n     */\n    constructor() {\n        CONTAINER.set(this, new Container());\n\n        this.setUp();\n    }\n\n    /**\n     * @protected\n     * @type {Container}\n     */\n    get container() {\n        return CONTAINER.get(this);\n    }\n\n    /**\n     * @protected\n     * @returns {void}\n     */\n    setUp() {\n        const container = this.container;\n\n        container.bindValue(ConfigContainer, this);\n        container.bindValue(ConfigEnvironment, new ConfigEnvironment(Object.entries(process.env)));\n        container.bindClass(ConfigCache, ConfigCache, [\n            ConfigEnvironment\n        ]);\n        container.bindValue(ConfigPatternCache, new ConfigPatternCache());\n        container.bindClass(ConfigStringResolver, ConfigStringResolver, [\n            ConfigEnvironment,\n            ConfigPatternCache\n        ]);\n        container.bindClass(ConfigPathResolver, ConfigPathResolver, [\n            ConfigStringResolver\n        ]);\n        container.bindClass(ConfigLoader, ConfigLoader, [\n            ConfigPathResolver,\n            ConfigCache,\n            ConfigFactory\n        ]);\n        container.bindClass(ConfigFactory, ConfigFactory, [\n            ConfigContainer\n        ]);\n        container.bindClass(Config, Config, Transient.with([\n            ConfigCommandFactory\n        ]));\n        container.bindClass(ConfigOptionsResolver, ConfigOptionsResolver, [\n            ConfigStringResolver\n        ]);\n        container.bindClass(ConfigDefaultsCommand, ConfigDefaultsCommand, [\n            ConfigOptionsResolver\n        ]);\n        container.bindClass(ConfigMergeCommand, ConfigMergeCommand, [\n            ConfigOptionsResolver\n        ]);\n        container.bindClass(ConfigExtendCommand, ConfigExtendCommand, [\n            ConfigOptionsResolver,\n            ConfigLoader,\n            ConfigFactory\n        ]);\n        container.bindClass(ConfigCommandFactory, ConfigCommandFactory, [\n            ConfigContainer\n        ]);\n    }\n\n    /**\n     * @param {*} T\n     * @returns {*}\n     */\n    resolve(T) {\n        return this.container.constitute(T);\n    }\n\n    /**\n     * @param {*} T\n     * @returns {Proxy<T>}\n     */\n    proxy(T) {\n        return new Proxy(function() {}, {\n            construct: () => {\n                return this.resolve(T);\n            }\n        });\n    }\n}\n\nexport default ConfigContainer;\n"]}